---
output:
  html_document: default
  pdf_document: default
---
---
# IDS 572 Data Mining Assignment 2 
## Aashish Bomma(650563462), Vishal Brahmananda(678517159)
title: "DM_Assignment_2"
author: "Vishal_Brahmanada(678517159), Aashish Bomma(650563462)"
date: "2022-10-04"
output: pdf_document

**Question 1:**
```{r}
train_data <- read.csv(file="C:/Users/vbrahm7/Documents/DM_Assignment_2/trainX.csv", header = F)
train_y <- read.csv(file = "C:/Users/vbrahm7/Documents/DM_Assignment_2/trainY.csv", header = F)
test_data <- read.csv(file = "C:/Users/vbrahm7/Documents/DM_Assignment_2/testX.csv", header = F)
test_y <- read.csv(file = "C:/Users/vbrahm7/Documents/DM_Assignment_2/testY.csv", header = F)
colnames(train_data) <- c("radius_mean", "texture_mean", "perimeter_mean", "area_mean", "smoothness_mean","compactness_mean", "concavity_mean", "concave_mean", "symmetry_mean", "fractal_mean","radius_sd", "texture_sd", "perimeter_sd", "area_sd", "smoothness_sd","compactness_sd", "concavity_sd", "concave_sd", "symmetry_sd", "fractal_sd","radius_max", "texture_max", "perimeter_max", "area_max", "smoothness_max","compactness_max", "concavity_max", "concave_max", "symmetry_max", "fractal_max")
colnames(test_data) <- c("radius_mean", "texture_mean", "perimeter_mean", "area_mean", "smoothness_mean","compactness_mean", "concavity_mean", "concave_mean", "symmetry_mean", "fractal_mean","radius_sd", "texture_sd", "perimeter_sd", "area_sd", "smoothness_sd","compactness_sd", "concavity_sd", "concave_sd", "symmetry_sd", "fractal_sd","radius_max", "texture_max", "perimeter_max", "area_max", "smoothness_max","compactness_max", "concavity_max", "concave_max", "symmetry_max", "fractal_max")
colnames(train_y) <- "malignant"
colnames(test_y) <- "malignant"
final_train_data <- cbind.data.frame(train_data,train_y)
final_test_data <- cbind.data.frame(test_data,test_y)
```
**Qestion 1a:**
```{r}
str(final_train_data)
str(final_test_data)

is.na(final_train_data)
is.na(final_test_data)
```
| No missing values in the final_train_data and final_test_data

| Radius, Perimeter, Area and Concavity could be the major predictors of diagnosis
```{r}
cor(final_train_data)
cor(final_test_data)

boxplot(final_train_data)
boxplot(final_test_data)
```
| There are outliers in the table. 

| Tree based models are resistant towards outliers and multicollinearity, so we use create a decision tree model.

**Question 1b:**
```{r}
library(rpart)
dtm <- rpart(malignant~., data= final_train_data, control = rpart.control(cp=-1, minsplit = 2))
print(dtm)

library(rpart.plot)
leaves<-length(unique(dtm$where))
print(leaves)
```

**Question 1c:**
```{r}
major_predictor<- dtm$variable.importance
major_predictor
```
| concave_mean, perimeter_max, concave_max are the major predictors as these are the top three important variables.
| We did predict that the concave and the perimeter could be the major predictors.  

**Question 1d:**
```{r}
print(dtm)
```
| Strong rule 1: smoothness_mean>=0.08027 & perimeter_max>=97.155 & texture_max>=20.875 & concave_mean>=0.05592
| support = (145/455)*100 = 31.21%
| confidence = (142/143)*100 = 99.3%

| Strong rule 2: smoothness_mean< 0.10865 & perimeter_max< 97.155 & texture_max>=20.875 & concave_mean>=0.05592
| support = (4/455)*100 = 0.88%
| confidence = (4/7)*100 = 57.1%

**Question 1e:**
```{r}
library(rpart)
```
| Training data accuracy
```{r}
predict_train_data<-predict(dtm, new_final_data = final_train_data)
table_train_data<- table(predict_train_data,final_train_data$malignant)
accuracy_train_data<- sum(diag(table_train_data))/sum(table_train_data)
print(accuracy_train_data)
```
| Test data accuracy
```{r}
predict_test_data<-predict(dtm,final_test_data)
table_test_data<-table(predict_test_data,final_test_data$malignant)
accuracy_test_data<-sum(diag(table_test_data))/sum(table_test_data)
print(accuracy_test_data)
```

**Question 1f:**
```{r}
printcp(dtm)
plotcp(dtm)
```
In order to predict the Y-lables, we construct the best possible decision tree and we get such a tree if we take cp value to be 0.023(the first value below the horizontal dotted line).
```{r}
best_dtm <- rpart(malignant~., data= final_train_data, control = rpart.control(cp=0.023, minsplit = 2))
print(best_dtm)
predict_best_dtm<-predict(best_dtm,final_train_data)
table_best_dtm<-table(predict_best_dtm,final_train_data$malignant)
best_dtm_recall <- table_best_dtm[2,2]/(table_best_dtm[2,1] + table_best_dtm[2,2])
print(best_dtm_recall)
best_dtm_precision <- table_best_dtm[2,2]/(table_best_dtm[1,2] + table_best_dtm[2,2])
print(best_dtm_precision)
accuracy_best_dtm<-sum(diag(table_best_dtm))/sum(table_best_dtm)
print(accuracy_best_dtm)
```
| The recall value = 0.01162791
| The precision value = 1
| The accuracy value = 0.05054945

**Question 1h:**
```{r}
rpart.plot(best_dtm)
rules_best_dtm<-rpart.rules(best_dtm)
print(rules_best_dtm)
```

**Question 2**
```{r}
zoo_data <- read.csv(file="C:/Users/vbrahm7/Documents/DM_Assignment_2/zoo.csv", header = T)
zoo_train_data <- read.csv(file = "C:/Users/vbrahm7/Documents/DM_Assignment_2/zoo1.csv", header = T)
zoo_test_data <- read.csv(file = "C:/Users/vbrahm7/Documents/DM_Assignment_2/zoo2.csv", header = T)
str(zoo_train_data)
library(dlookr)
describe(zoo_data)
unique(zoo_data$animal)
unique(zoo_data$type)
summary(zoo_data)
```

**Question 2a:**
```{r}
train_zoo_data <- zoo_train_data[ ,-1]
library(rpart)
zoo_dtm <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_train_data, control = rpart.control(cp=0.01, minsplit = 2))
print(zoo_dtm)
zoo_test_dtm <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize  , data= zoo_test_data, control = rpart.control(cp=0.01, minsplit = 2))
print(zoo_test_dtm)
```
**Question 2b:**
```{r}
library(rpart.plot)
rpart.plot(zoo_dtm)
rpart.plot(zoo_test_dtm)
```
```{r}
zoo_train_leaves<-length(unique(zoo_dtm$where))
print(zoo_train_leaves)
```
| The zoo tree has 7 leaves.
```{r}
zoo_test_leaves<-length(unique(zoo_test_dtm$where))
print(zoo_test_leaves)
```
| The zoo test tree has 7 leaves

| accuracy of zoo train data:
```{r}
predict_zoo_train_data<-predict(zoo_dtm, new_final_data = zoo_train_data,type= "class")
table_zoo_train_data<- table(predict_zoo_train_data,zoo_train_data$type)
accuracy_zoo_train_data<- sum(diag(table_zoo_train_data))/sum(table_zoo_train_data)
print(accuracy_zoo_train_data)
```
| accuracy of zoo test data:
```{r}
predict_zoo_test_data<-predict(zoo_test_dtm, new_final_data = zoo_test_data,type= "class")
table_zoo_test_data<- table(predict_zoo_test_data,zoo_test_data$type)
accuracy_zoo_test_data<- sum(diag(table_zoo_test_data))/sum(table_zoo_test_data)
print(accuracy_zoo_test_data)
```
**Question 2c:**
```{r}
library(rpart)
printcp(zoo_dtm)
plotcp(zoo_dtm)
```
| The optimum value of cp in the train zoo data set = 0.027
```{r}
printcp(zoo_test_dtm)
plotcp(zoo_test_dtm)
```
| The optimum value of cp in the test zoo data set = 0.074

| i)We are taking control values of minbucket=10,cp=0.027,minsplit=10
```{r}
zoo_dtm_10 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_train_data, control = rpart.control(minbucket = 10,cp=0.027, minsplit = 10))
print(zoo_dtm_10)
```
| We are taking control values of minbucket=10,cp=0.074,minsplit=10
```{r}
zoo_test_dtm_10 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize  , data= zoo_test_data, control = rpart.control(minbucket =10,cp=0.074, minsplit = 10))
print(zoo_test_dtm_10)
```

| The recall, precision,accuracy for the above control values for above train data:
```{r}
predict_zoo_train_data_10<-predict(zoo_dtm_10, new_final_data = zoo_train_data,type= "class")
table_zoo_train_data_10<- table(predict_zoo_train_data_10,zoo_train_data$type)
zoo_train_recall_10 <- table_zoo_train_data_10[2,2]/(table_zoo_train_data_10[2,1] + table_zoo_train_data_10[2,2])
print(zoo_train_recall_10)
zoo_train_precision_10 <- table_zoo_train_data_10[2,2]/(table_zoo_train_data_10[1,2] + table_zoo_train_data_10[2,2])
print(zoo_train_precision_10)
accuracy_zoo_train_data_10<- sum(diag(table_zoo_train_data_10))/sum(table_zoo_train_data_10)
print(accuracy_zoo_train_data_10)
```
| The recall value = 1
| The precision = 1
| The accuracy = 0.8450
 
| The recall, precision,accuracy for the above control values for above test data:
```{r}
predict_zoo_test_data_10<-predict(zoo_test_dtm_10, new_final_data = zoo_test_data,type= "class")
table_zoo_test_data_10<- table(predict_zoo_test_data_10,zoo_test_data$type)
zoo_test_recall_10 <- table_zoo_test_data_10[2,2]/(table_zoo_test_data_10[2,1] + table_zoo_test_data_10[2,2])
print(zoo_test_recall_10)
zoo_test_precision_10 <- table_zoo_test_data_10[2,2]/(table_zoo_test_data_10[1,2] + table_zoo_test_data_10[2,2])
print(zoo_test_precision_10)
accuracy_zoo_test_data_10<- sum(diag(table_zoo_test_data_10))/sum(table_zoo_test_data_10)
print(accuracy_zoo_test_data_10)
```
| The recall value = 0.85714
| The precision = 1
| The accuracy = 0.566

| ii)we are taking control values of minbucket=1,minsplit=6
```{r}
zoo_dtm_1 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_train_data, control = rpart.control(minbucket = 1,cp=0.027, minsplit = 6))
print(zoo_dtm_1)
zoo_test_dtm_1 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_test_data, control = rpart.control(minbucket = 1,cp=0.074, minsplit = 6))
print(zoo_test_dtm_1)
```
| The recall, precision,accuracy for the above control values for above train data:
```{r}
predict_zoo_train_data_1<-predict(zoo_dtm_1, new_final_data = zoo_train_data,type= "class")
table_zoo_train_data_1<- table(predict_zoo_train_data_1,zoo_train_data$type)
zoo_train_recall_1 <- table_zoo_train_data_1[2,2]/(table_zoo_train_data_1[2,1] + table_zoo_train_data_1[2,2])
print(zoo_train_recall_1)
zoo_train_precision_1 <- table_zoo_train_data_1[2,2]/(table_zoo_train_data_1[1,2] + table_zoo_train_data_1[2,2])
print(zoo_train_precision_1)
accuracy_zoo_train_data_1<- sum(diag(table_zoo_train_data_1))/sum(table_zoo_train_data_1)
print(accuracy_zoo_train_data_1)
```
| The recall value = 1
| The precision = 1
| The accuracy = 1

| The recall, precision,accuracy for the above control values for above test data:
```{r}
predict_zoo_test_data_1<-predict(zoo_test_dtm_1, new_final_data = zoo_test_data,type= "class")
table_zoo_test_data_1<- table(predict_zoo_test_data_1,zoo_test_data$type)
zoo_test_recall_1 <- table_zoo_test_data_1[2,2]/(table_zoo_test_data_1[2,1] + table_zoo_test_data_1[2,2])
print(zoo_test_recall_1)
zoo_test_precision_1 <- table_zoo_test_data_1[2,2]/(table_zoo_test_data_1[1,2] + table_zoo_test_data_1[2,2])
print(zoo_test_precision_1)
accuracy_zoo_test_data_1<- sum(diag(table_zoo_test_data_1))/sum(table_zoo_test_data_1)
print(accuracy_zoo_test_data_1)
```
| The recall value = 1
| The precision = 1
| The accuracy = 0.966

| We are taking control values of minbucket=7,minsplit=17
```{r}
zoo_dtm_7 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_train_data, control = rpart.control(minbucket = 7,cp=0.027, minsplit = 17))
print(zoo_dtm_7)
zoo_test_dtm_7 <- rpart(type ~ hair + feathers + eggs + milk + airborne + aquatic + predator + toothed + backbone + breathes + venomous + fins + legs + tail + domestic + catsize , data= zoo_test_data, control = rpart.control(minbucket = 7,cp=0.074, minsplit = 17))
print(zoo_test_dtm_7)
```

| The recall, precision,accuracy for the above control values for above train data:
```{r}
predict_zoo_train_data_7<-predict(zoo_dtm_7, new_final_data = zoo_train_data,type= "class")
table_zoo_train_data_7<- table(predict_zoo_train_data_7,zoo_train_data$type)
zoo_train_recall_7 <- table_zoo_train_data_7[2,2]/(table_zoo_train_data_7[2,1] + table_zoo_train_data_7[2,2])
print(zoo_train_recall_7)
zoo_train_precision_7 <- table_zoo_train_data_7[2,2]/(table_zoo_train_data_7[1,2] + table_zoo_train_data_7[2,2])
print(zoo_train_precision_7)
accuracy_zoo_train_data_7<- sum(diag(table_zoo_train_data_7))/sum(table_zoo_train_data_7)
print(accuracy_zoo_train_data_7)
```
| The recall value = 1
| The precision = 1
| The accuracy = 0.887

| The recall, precision,accuracy for the above control values for above test data:
```{r}
predict_zoo_test_data_7<-predict(zoo_test_dtm_7, new_final_data = zoo_test_data,type= "class")
table_zoo_test_data_7<- table(predict_zoo_test_data_7,zoo_test_data$type)
zoo_test_recall_7 <- table_zoo_test_data_7[2,2]/(table_zoo_test_data_7[2,1] + table_zoo_test_data_7[2,2])
print(zoo_test_recall_7)
zoo_test_precision_7 <- table_zoo_test_data_7[2,2]/(table_zoo_test_data_7[1,2] + table_zoo_test_data_7[2,2])
print(zoo_test_precision_7)
accuracy_zoo_test_data_7<- sum(diag(table_zoo_test_data_7))/sum(table_zoo_test_data_7)
print(accuracy_zoo_test_data_7)
```
| The recall value = 0.85714
| The precision = 1
| The accuracy = 0.966

| ![The recall, precision,accuracy for train data](C:/Users/vbrahm7/Documents/DM_Assignment_2/train_accuracy.jpg)

| ![The recall, precision,accuracy for train data](C:/Users/vbrahm7/Documents/DM_Assignment_2/test_accuracy.jpg)

  
**Question 2d:**

| Accuracy for type = milk
```{r}
zoo_dtm_milk <- rpart(type ~ milk , data= zoo_data, control = rpart.control(cp=0.01, minsplit = 2))
print(zoo_dtm_milk)
predict_zoo_data_milk<-predict(zoo_dtm_milk, new_final_data = zoo_data,type= "class")
table_zoo_data_milk<- table(predict_zoo_data_milk,zoo_data$type)
zoo_milk_recall <- table_zoo_data_milk[2,2]/(table_zoo_data_milk[2,1] + table_zoo_data_milk[2,2])
print(zoo_milk_recall)
zoo_milk_precision <- table_zoo_data_milk[2,2]/(table_zoo_data_milk[1,2] + table_zoo_data_milk[2,2])
print(zoo_milk_precision)
accuracy_zoo_data_milk<- sum(diag(table_zoo_data_milk))/sum(table_zoo_data_milk)
print(accuracy_zoo_data_milk)
```

| Accuracy for type = feathers
```{r}
zoo_dtm_feather <- rpart(type ~ feathers , data= zoo_data, control = rpart.control(cp=0.01, minsplit = 2))
print(zoo_dtm_feather)
predict_zoo_data_feather<-predict(zoo_dtm_feather, new_final_data = zoo_data,type= "class")
table_zoo_data_feather<- table(predict_zoo_data_feather,zoo_data$type)
zoo_feathers_recall <- table_zoo_data_feather[2,2]/(table_zoo_data_feather[2,1] + table_zoo_data_feather[2,2])
print(zoo_feathers_recall)
zoo_feathers_precision <- table_zoo_data_feather[2,2]/(table_zoo_data_feather[1,2] + table_zoo_data_feather[2,2])
print(zoo_feathers_precision)
accuracy_zoo_data_feather<- sum(diag(table_zoo_data_feather))/sum(table_zoo_data_feather)
print(accuracy_zoo_data_feather)
```

| Accuracy for type = aquatic
```{r}
zoo_dtm_aquatic <- rpart(type ~ aquatic , data= zoo_data, control = rpart.control(cp=0.01, minsplit = 2))
print(zoo_dtm_aquatic)
predict_zoo_data_aquatic<-predict(zoo_dtm_aquatic, new_final_data = zoo_data,type= "class")
table_zoo_data_aquatic<- table(predict_zoo_data_aquatic,zoo_data$type)
zoo_aquatic_recall <- table_zoo_data_aquatic[2,2]/(table_zoo_data_aquatic[2,1] + table_zoo_data_aquatic[2,2])
print(zoo_aquatic_recall)
zoo_aquatic_precision <- table_zoo_data_aquatic[2,2]/(table_zoo_data_aquatic[1,2] + table_zoo_data_aquatic[2,2])
print(zoo_aquatic_precision)
accuracy_zoo_data_aquatic<- sum(diag(table_zoo_data_aquatic))/sum(table_zoo_data_aquatic)
print(accuracy_zoo_data_aquatic)
```

| The accuracy and precision for "milk" and "feathers" is same but recall for milk is less than recall for feathers, so we get best results with "feathers".
